<div class="scrollable-container">
  <form [formGroup]="auditForm">
    <nb-accordion multi>
      <nb-accordion-item expanded>
        <nb-accordion-item-header>
          1. Audit Grunddaten
        </nb-accordion-item-header>
        <nb-accordion-item-body>
          <div class="grid-2-1-1">
            <div class="form-item">
              <label class="label">Auditname</label>
              <input [status]="auditName.invalid && auditName.touched ? 'danger' : 'basic'" formControlName="auditName" nbInput fullWidth />
              <div *ngIf="auditName.invalid && auditName.touched">
                <label class="label text-danger">Auditnamen eintragen</label>
              </div>
            </div>
            <div class="form-item">
              <label class="label">Startdatum</label>
              <input formControlName="start" type="date" nbInput fullWidth />
            </div>
            <div class="form-item">
              <label class="label">Enddatum</label>
              <input formControlName="end" type="date" nbInput fullWidth />
            </div>
          </div>
        </nb-accordion-item-body>
      </nb-accordion-item>

      <nb-accordion-item>
        <nb-accordion-item-header>
          2. Kundendaten
        </nb-accordion-item-header>
        <nb-accordion-item-body>
          <div class="grid-2-1-1">
            <div class="form-item">
              <label class="label">Unternehmen</label>
              <input formControlName="companyName" [status]="companyName.invalid && companyName.touched ? 'danger' : 'basic'" nbInput fullWidth />
              <div *ngIf="companyName.invalid && companyName.touched">
                <label class="label text-danger">Unternehmen eintragen</label>
              </div>
            </div>
            <div class="form-item">
              <label class="label">Abteilung</label>
              <input formControlName="department" [status]="department.invalid && department.touched ? 'danger' : 'basic'" nbInput fullWidth />
              <div *ngIf="department.invalid && department.touched">
                <label class="label text-danger">Abteilung eintragen</label>
              </div>
            </div>
            <div class="form-item">
              <label class="label">Branche</label>
              <input formControlName="sector" [status]="sector.invalid && sector.touched ? 'danger' : 'basic'" nbInput fullWidth status="danger" />
              <div *ngIf="sector.invalid && sector.touched">
                <label class="label text-danger">Branche eintragen</label>
              </div>
            </div>
          </div>
        </nb-accordion-item-body>
      </nb-accordion-item>

      <nb-accordion-item>
        <nb-accordion-item-header>
          3. Kontaktdaten
        </nb-accordion-item-header>
        <nb-accordion-item-body>
          <div class="grid-auto-1-1 mb-2">
            <div class="form-item">
              <label class="label">Titel</label>
              <nb-select formControlName="title" [status]="title.invalid && title.touched ? 'danger' : 'basic'" fullWidth>
                <nb-option value="Herr">Herr</nb-option>
                <nb-option value="Frau">Frau</nb-option>
              </nb-select>
              <div *ngIf="title.invalid && title.touched">
                <label class="label text-danger">Titel wählen</label>
              </div>
            </div>
            <div class="form-item">
              <label class="label">Vorname</label>
              <input formControlName="firstName" [status]="firstName.invalid && firstName.touched ? 'danger' : 'basic'" nbInput fullWidth />
              <div *ngIf="firstName.invalid && firstName.touched">
                <label class="label text-danger">Vornamen eintragen</label>
              </div>
            </div>
            <div class="form-item">
              <label class="label">Nachname</label>
              <input formControlName="lastName" [status]="lastName.invalid && lastName.touched ? 'danger' : 'basic'" nbInput fullWidth />
              <div *ngIf="lastName.invalid && lastName.touched">
                <label class="label text-danger">Nachnamen eintragen</label>
              </div>
            </div>
          </div>
          <div style="margin-top: 10px;" class="form-item">
            <label class="label">Kontaktinformation</label>
            <textarea
              spellcheck="false"
              nbInput
              formControlName="contactInformation"
              [status]="contactInformation.invalid && contactInformation.touched ? 'danger' : 'basic'"
              placeholder="Erreichbar unter..."
              fullWidth
            ></textarea>
            <div *ngIf="contactInformation.invalid && contactInformation.touched">
              <label class="label text-danger">Kontaktinformationen eintragen</label>
            </div>
          </div>
        </nb-accordion-item-body>
      </nb-accordion-item>
      <nb-accordion-item>
        <nb-accordion-item-header>4. ISO/IEC 25010 Kategorien</nb-accordion-item-header>
        <nb-accordion-item-body>
          <div class="category-container">
            <ul *ngFor="let parentCategory of categories">
              <nb-checkbox (checkedChange)="$event ? addParentCategory(parentCategory) : removeParentCategory(parentCategory)" [checked]="isChecked(parentCategory.title)">
                {{ parentCategory.title }}
              </nb-checkbox>
              <li *ngFor="let childCategory of parentCategory.children">
                <nb-checkbox (checkedChange)="$event ? addChildCategory(childCategory, parentCategory) : removeChildCategory(childCategory, parentCategory)" [checked]="isChecked(childCategory.title)">
                  {{ childCategory.title }}
                </nb-checkbox>
              </li>
            </ul>
          </div>
        </nb-accordion-item-body>
      </nb-accordion-item>

      <nb-accordion-item expanded>
        <nb-accordion-item-header style="display: none;"></nb-accordion-item-header>
        <nb-accordion-item-body>
          <div class="accordion-footer">
            <button (click)="onCancel()" hero nbButton>
              abbrechen
            </button>
            <button (click)="onSubmit()" [disabled]="auditForm.invalid" status="primary" hero nbButton>
              hinzufügen
            </button>
          </div>
        </nb-accordion-item-body>
      </nb-accordion-item>
    </nb-accordion>
  </form>
</div>
